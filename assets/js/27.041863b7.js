(window.webpackJsonp=window.webpackJsonp||[]).push([[27],{446:function(e,s,n){"use strict";n.r(s);var t=n(2),a=Object(t.a)({},(function(){var e=this,s=e._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[s("p",[e._v("简介：项目中打包是是使用的 Vite，在测试阶段发现在低版本的浏览器中，项目界面会出现白屏的现象？")]),e._v(" "),s("p",[e._v("于是我尝试着去解决问题，我首先有下面的几种排查方案？")]),e._v(" "),s("ol",[s("li",[e._v("打开代码，本地运行，看后台是否有报错，如果有，先解决报错？")])]),e._v(" "),s("p",[e._v("验证结果：查看后，发现后台并没有报错，代码无任何异常")]),e._v(" "),s("ol",{attrs:{start:"2"}},[s("li",[e._v("写一个 html 页面部署到服务器上，然后在有问题的浏览器上测一下，看是否还出现白屏？")])]),e._v(" "),s("p",[e._v("验证结果：部署上去发现无白屏，正常显示")]),e._v(" "),s("blockquote",[s("p",[e._v("通过 2 发现可能是兼容性问题，"),s("a",{attrs:{href:"https://cn.vitejs.dev/guide/why.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("然后我去查看了 vite 的文档"),s("OutboundLink")],1),e._v("，发现可能会对低版本的浏览器不兼容，可以使用"),s("code",[e._v("@vitejs/plugin-legacy")]),e._v("插件做一下兼容")])]),e._v(" "),s("h4",{attrs:{id:"vitejs-plugin-legacy"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#vitejs-plugin-legacy"}},[e._v("#")]),e._v(" @vitejs/plugin-legacy")]),e._v(" "),s("p",[s("a",{attrs:{href:"https://github.com/vitejs/vite/tree/main/packages/plugin-legacy",target:"_blank",rel:"noopener noreferrer"}},[e._v("具体详细文档可以看官方"),s("OutboundLink")],1)]),e._v(" "),s("p",[e._v("安装插件")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("yarn add @vitejs/plugin-legacy -D\nyarn add terser -D\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br")])]),s("p",[s("img",{attrs:{src:"https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/89f946e13c1f4858812e5087a3f9a4e3~tplv-k3u1fbpfcp-watermark.image?",alt:"image.png"}})]),e._v(" "),s("p",[e._v("然后做以下配置")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("import legacy from '@vitejs/plugin-legacy'\n\nexport default {\n  plugins: [\n    legacy({\n      targets: ['Chrome 64'],\n      additionalLegacyPolyfills: ['regenerator-runtime/runtime'],\n      renderLegacyChunks: true,\n      polyfills: [\n        'es.symbol',\n        'es.array.filter',\n        'es.promise',\n        'es.promise.finally',\n        'es/map',\n        'es/set',\n        'es.array.for-each',\n        'es.object.define-properties',\n        'es.object.define-property',\n        'es.object.get-own-property-descriptor',\n        'es.object.get-own-property-descriptors',\n        'es.object.keys',\n        'es.object.to-string',\n        'web.dom-collections.for-each',\n        'esnext.global-this',\n        'esnext.string.match-all'\n      ]}\n    }),\n  ],\n}\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br"),s("span",{staticClass:"line-number"},[e._v("5")]),s("br"),s("span",{staticClass:"line-number"},[e._v("6")]),s("br"),s("span",{staticClass:"line-number"},[e._v("7")]),s("br"),s("span",{staticClass:"line-number"},[e._v("8")]),s("br"),s("span",{staticClass:"line-number"},[e._v("9")]),s("br"),s("span",{staticClass:"line-number"},[e._v("10")]),s("br"),s("span",{staticClass:"line-number"},[e._v("11")]),s("br"),s("span",{staticClass:"line-number"},[e._v("12")]),s("br"),s("span",{staticClass:"line-number"},[e._v("13")]),s("br"),s("span",{staticClass:"line-number"},[e._v("14")]),s("br"),s("span",{staticClass:"line-number"},[e._v("15")]),s("br"),s("span",{staticClass:"line-number"},[e._v("16")]),s("br"),s("span",{staticClass:"line-number"},[e._v("17")]),s("br"),s("span",{staticClass:"line-number"},[e._v("18")]),s("br"),s("span",{staticClass:"line-number"},[e._v("19")]),s("br"),s("span",{staticClass:"line-number"},[e._v("20")]),s("br"),s("span",{staticClass:"line-number"},[e._v("21")]),s("br"),s("span",{staticClass:"line-number"},[e._v("22")]),s("br"),s("span",{staticClass:"line-number"},[e._v("23")]),s("br"),s("span",{staticClass:"line-number"},[e._v("24")]),s("br"),s("span",{staticClass:"line-number"},[e._v("25")]),s("br"),s("span",{staticClass:"line-number"},[e._v("26")]),s("br"),s("span",{staticClass:"line-number"},[e._v("27")]),s("br"),s("span",{staticClass:"line-number"},[e._v("28")]),s("br"),s("span",{staticClass:"line-number"},[e._v("29")]),s("br")])]),s("h3",{attrs:{id:"项目打包"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#项目打包"}},[e._v("#")]),e._v(" 项目打包")]),e._v(" "),s("p",[e._v("开始打包，看下是否解决？")]),e._v(" "),s("p",[e._v("哈哈哈哈，打包报错了")]),e._v(" "),s("blockquote",[s("p",[e._v("[vite:build-html] Cannot destructure property 'renderBuiltUrl' of 'config.experimental' as it is undefined.\nerror during build:\nTypeError: Cannot destructure property 'renderBuiltUrl' of 'config.experimental' as it is undefined.")])]),e._v(" "),s("p",[e._v("原因："),s("strong",[e._v("plugin-legacy 版本为 2.x 后，vite 版本需要为 3.x 版本。如果 vit 版本是 2.x，plugin-legacy 就需要降到 1.x")]),e._v("，")]),e._v(" "),s("p",[e._v("解决：这个项目之前是别人写好上线了的，为了风险控制，我尽可能不改动他 vite 的版本，所以我选择降低 plugin-legacy 的版本")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v('"@vitejs/plugin-legacy": "^1.8.2",\n')])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("p",[e._v("yarn 完之后，重新进行打包，发现成功了，运行也正常")]),e._v(" "),s("p",[e._v("验证：在低版本浏览器进行验证，发现页面也正常显示了，又测了其他的，也都正常")]),e._v(" "),s("p",[e._v("最后：记录解决问题的过程，如有问题，欢迎指正。")])])}),[],!1,null,null,null);s.default=a.exports}}]);